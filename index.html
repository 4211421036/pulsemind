<!DOCTYPE html>
<html lang="en">
<head><head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="format-detection" content="telephone=no">
    
    <title>PulseMind | Real-time GSR Monitoring for Stress Detection</title>
    <meta name="description" content="Open-source psychophysiological monitoring system measuring galvanic skin response (GSR) for stress analysis using ESP32 and web visualization">
    <meta name="keywords" content="GSR, EDA, stress monitoring, psychophysiology, ESP32, biomedical sensors, mental health tech">
    <meta name="author" content="Hanifa Septi Larasati">
    <meta name="robots" content="index, follow, max-image-preview:large">
    <meta name="revisit-after" content="7 days">
    
    <link rel="canonical" href="https://4211421036.github.io/pulsemind">
    
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://4211421036.github.io/pulsemind">
    <meta property="og:title" content="PulseMind | GSR Stress Monitoring System">
    <meta property="og:description" content="Real-time electrodermal activity visualization for mental health research">
    <meta property="og:image" content="https://4211421036.github.io/pulsemind/img/181849.png">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:site_name" content="PulseMind">
    <meta name="robots" content="index, follow">
    
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="PulseMind | Real-time Stress Detection">
    <meta name="twitter:description" content="Open-source GSR monitoring platform for psychophysiology research">
    <meta name="twitter:image" content="https://4211421036.github.io/pulsemind/img/181849.png">
    
    <!-- PWA Configuration -->
    <link rel="manifest" href="https://4211421036.github.io/pulsemind/manifest.webmanifest">
    <meta name="theme-color" content="#15193B">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="apple-touch-icon" href="https://4211421036.github.io/g4lihru/987654567.png">
    
    <!-- Favicon & App Icons -->
    <link rel="icon" href="https://4211421036.github.io/g4lihru/987654567.png">
    <link rel="mask-icon" href="https://4211421036.github.io/g4lihru/987654567.png" color="#4a90e2">
    
    <!-- Preload Critical Resources -->
    <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" as="style" crossorigin="anonymous">
    <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js" as="script" crossorigin="anonymous">
    
    <!-- DNS Prefetch -->
    <link rel="dns-prefetch" href="https://cdnjs.cloudflare.com">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    
    <!-- CSS Resources -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw==" crossorigin="anonymous" referrerpolicy="no-referrer">
    
    <!-- Structured Data -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "SoftwareApplication",
      "name": "PulseMind",
      "description": "GSR monitoring system for stress detection",
      "url": "https://4211421036.github.io/pulsemind",
      "applicationCategory": "HealthApplication",
      "operatingSystem": "Web, ESP32",
      "author": {
        "@type": "Person",
        "name": "Hanifa Septi Larasati"
      },
      "datePublished": "2025-04-01",
      "softwareVersion": "1.0.0"
    }
    </script>
    
    <!-- Browser Features -->
    <meta name="referrer" content="strict-origin-when-cross-origin">
    <style>
        :root {
            --primary: #4A90E2;
            --relaxed: #6BCB77;
            --normal: #FFD93D;
            --stressed: #FF9671;
            --high-stress: #FF6B6B;
            --bg-color: #15193B;
            --card-bg: #1E2746;
            --text-color: #E9ECEF;
            --text-secondary: #ADB5BD;
            --card-shadow: 0 4px 15px rgba(0,0,0,0.2);
            --border-radius: 16px;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            line-height: 1.6;
            overflow-x: hidden;
        }

        .dashboard {
            margin: 0 auto;
            padding: 20px;
        }

        .nav-tabs {
            display: flex;
            margin-bottom: 20px;
            background: rgba(30, 39, 70, 0.5);
            border-radius: 50px;
            padding: 5px;
            width: fit-content;
        }

        .nav-tab {
            padding: 10px 20px;
            border-radius: 50px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .nav-tab.active {
            background: #FFC107;
            color: #1E1E1E;
        }

        .card {
            background: var(--card-bg);
            border-radius: var(--border-radius);
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: var(--card-shadow);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        h1, h2, h3 {
            color: var(--text-color);
            font-weight: 600;
        }

        .real-time {
            text-align: right;
        }

        #current-stress {
            font-size: 2.5rem;
            font-weight: bold;
            background: linear-gradient(135deg, #6BCB77 0%, #FFD93D 50%, #FF6B6B 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .status {
            font-size: 1rem;
            font-weight: 500;
            padding: 5px 12px;
            border-radius: 20px;
            display: inline-block;
        }

        .chart-container {
            height: 300px;
            position: relative;
            margin: 20px 0;
        }

        .stress-meter {
            height: 10px;
            background: linear-gradient(to right, 
                var(--relaxed) 0%,
                var(--normal) 35%,
                var(--stressed) 60%,
                var(--high-stress) 100%);
            border-radius: 10px;
            position: relative;
            margin: 30px 0 10px;
        }

        .stress-indicator {
            position: absolute;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #fff;
            top: -5px;
            transform: translateX(-50%);
            box-shadow: 0 0 10px rgba(0,0,0,0.3);
            border: 3px solid var(--card-bg);
            transition: left 0.5s ease;
        }

        .stress-labels {
            display: flex;
            justify-content: space-between;
            margin-top: 5px;
            color: var(--text-secondary);
            font-size: 0.8rem;
        }

        .metric-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-top: 20px;
        }

        .metric-item {
            background: rgba(255,255,255,0.05);
            padding: 15px;
            border-radius: 12px;
            text-align: center;
        }

        .metric-item label {
            display: block;
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin-bottom: 5px;
        }

        .value {
            font-size: 1.4rem;
            font-weight: bold;
        }

        .trend {
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            margin-top: 5px;
        }

        .trend i {
            margin-right: 5px;
        }

        .trend-up {
            color: var(--high-stress);
        }

        .trend-down {
            color: var(--relaxed);
        }

        .trend-stable {
            color: var(--normal);
        }

        .weekly-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 10px;
            overflow-x: auto;
            padding-bottom: 10px;
        }

        .weekly-day {
            text-align: center;
            min-width: 60px;
        }

        .weekly-day .day {
            font-size: 0.8rem;
            color: var(--text-secondary);
            margin-bottom: 5px;
        }

        .weekly-day .stress-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            margin: 0 auto 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
        }

        .weekly-day .stress-level {
            font-weight: 600;
            font-size: 1.1rem;
        }

        .weekly-day .stress-range {
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        .btn-action {
            display: block;
            width: 100%;
            padding: 12px;
            margin-top: 15px;
            background-color: var(--primary);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .btn-action:hover {
            background-color: #3a7bc8;
        }

        /* Hourly forecast style */
        .hourly-forecast {
            display: flex;
            overflow-x: auto;
            padding: 10px 0;
            scrollbar-width: thin;
            scrollbar-color: var(--primary) transparent;
            margin: 15px 0;
        }

        .hourly-forecast::-webkit-scrollbar {
            height: 6px;
        }

        .hourly-forecast::-webkit-scrollbar-thumb {
            background-color: var(--primary);
            border-radius: 10px;
        }

        .forecast-hour {
            display: flex;
            flex-direction: column;
            align-items: center;
            min-width: 80px;
            padding: 10px;
        }

        .forecast-time {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-bottom: 10px;
        }

        .forecast-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            margin-bottom: 8px;
        }

        .forecast-value {
            font-weight: 600;
            font-size: 1.1rem;
        }

        /* Modal Styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.7);
            backdrop-filter: blur(5px);
            z-index: 100;
            display: none;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .modal {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 90%;
            max-width: 500px;
            background: var(--card-bg);
            border-radius: var(--border-radius);
            box-shadow: 0 15px 40px rgba(0,0,0,0.3);
            z-index: 101;
            display: none;
            overflow: hidden;
        }

        .modal-content {
            padding: 25px;
            max-height: 80vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .close-modal {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--text-color);
        }

        .analysis-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
        }

        .analysis-item {
            background: rgba(255,255,255,0.05);
            padding: 15px;
            border-radius: 12px;
        }

        .analysis-item label {
            display: block;
            margin-bottom: 5px;
            display: flex;
            align-items: center;
        }

        .analysis-item label i {
            margin-right: 8px;
        }

        .analysis-item small {
            display: block;
            margin-top: 5px;
            color: var(--text-secondary);
            font-size: 0.8rem;
        }

        .progress-bar {
            height: 8px;
            border-radius: 4px;
            background: rgba(255,255,255,0.1);
            margin: 10px 0;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            transition: width 0.5s ease;
        }

        /* Recommendation styles */
        .recommendations {
            margin-top: 20px;
        }

        .recommendation-item {
            display: flex;
            align-items: flex-start;
            padding: 15px;
            background: rgba(255,255,255,0.05);
            border-radius: 12px;
            margin-bottom: 15px;
        }

        .recommendation-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            flex-shrink: 0;
        }

        .recommendation-content h4 {
            margin-bottom: 5px;
        }

        .recommendation-content p {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        /* Responsive Design */
        @media (min-width: 768px) {
            .dashboard-grid {
                display: grid;
                grid-template-columns: 2fr 1fr;
                gap: 20px;
            }
            
            .card {
                padding: 25px;
                margin-bottom: 20px;
            }

            .analysis-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 768px) {
            .weekly-grid {
                grid-template-columns: repeat(7, 80px);
            }
        }

        @media (max-width: 480px) {
            .nav-tab {
                padding: 8px 15px;
                font-size: 0.9rem;
            }
            
            #current-stress {
                font-size: 2rem;
            }
            
            .value {
                font-size: 1.2rem;
            }

            .metric-grid {
                grid-template-columns: 1fr;
            }
        }
    .tab-content {
    display: none;
}

.tab-content.active {
    display: block;
}

/* Trend charts styling */
.chart-container {
    position: relative;
    height: 300px;
    margin-bottom: 20px;
}

/* Insights styling */
.insight-item, .trigger-item, .key-insight, .achievement, .alert-item {
    display: flex;
    align-items: center;
    padding: 12px;
    margin-bottom: 10px;
    border-radius: 8px;
    background: rgba(255, 255, 255, 0.05);
}

.insight-icon, .achievement-badge {
    width: 36px;
    height: 36px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-right: 12px;
    flex-shrink: 0;
}

.insight-content, .achievement-content {
    flex-grow: 1;
}

.insight-content h4, .achievement-content h4 {
    margin: 0 0 4px 0;
    font-size: 14px;
}

.insight-content p, .achievement-content p {
    margin: 0;
    font-size: 13px;
    opacity: 0.8;
}

/* Trigger bars */
.trigger-item {
    padding: 8px 12px;
}

.trigger-category {
    width: 80px;
    font-size: 13px;
}

.trigger-bar {
    flex-grow: 1;
    height: 8px;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 4px;
    margin: 0 12px;
    overflow: hidden;
}

.trigger-fill {
    height: 100%;
    border-radius: 4px;
}

.trigger-value {
    width: 60px;
    text-align: right;
    font-size: 12px;
    opacity: 0.7;
}

/* Key insights */
.key-insight {
    padding: 12px;
    border-left: 4px solid;
    margin-bottom: 12px;
}

.key-insight.positive {
    border-left-color: var(--relaxed);
    background: rgba(74, 226, 144, 0.1);
}

.key-insight.negative {
    border-left-color: var(--high-stress);
    background: rgba(226, 74, 74, 0.1);
}

.key-insight i {
    font-size: 20px;
    margin-right: 12px;
}

.key-insight.positive i {
    color: var(--relaxed);
}

.key-insight.negative i {
    color: var(--high-stress);
}

/* Alerts */
.alert-item {
    padding: 10px 12px;
    margin-bottom: 10px;
    border-radius: 6px;
}

.alert-item.warning {
    background: rgba(226, 170, 74, 0.1);
    border-left: 4px solid var(--stressed);
}

.alert-item.info {
    background: rgba(74, 144, 226, 0.1);
    border-left: 4px solid var(--primary);
}

.alert-item i {
    font-size: 20px;
    margin-right: 12px;
}

.alert-item.warning i {
    color: var(--stressed);
}

.alert-item.info i {
    color: var(--primary);
}

.alert-item h4 {
    margin: 0 0 4px 0;
    font-size: 14px;
}

.alert-item p {
    margin: 0;
    font-size: 13px;
    opacity: 0.8;
}
</style>
    <script src="https://www.googletagmanager.com/gtag/js?id=G-10CPK9SS6N" async></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-10CPK9SS6N")</script>
    <meta name="google-site-verification" content="OYdjPwgIjGMAbQd3CGwM_l20jLNRRp84mEl3kw06DMg" />
</head>
<body>
    <noscript><iframe height=0 src="https://www.googletagmanager.com/ns.html?id=GTM-NN8S46CR" style=display:none;visibility:hidden width=0></iframe></noscript>
    <div class="dashboard">
    <div class="nav-tabs">
        <div class="nav-tab active" data-tab="overview">Overview</div>
        <div class="nav-tab" data-tab="trends">Trends</div>
        <div class="nav-tab" data-tab="insights">Insights</div>
    </div>

    <!-- Overview Tab (existing content) -->
    <div class="tab-content active" id="overview">
        <div class="dashboard-grid">
            <div class="main-column">
                <div class="card main-card">
                    <div class="header">
                        <h2><i class="fas fa-brain"></i> Real-time Mental State</h2>
                        <div class="real-time">
                            <div id="current-stress">0%</div>
                            <div class="status" id="current-status">Calibrating...</div>
                        </div>
                    </div>
                    
                    <div class="stress-meter">
                        <div class="stress-indicator" id="stress-indicator"></div>
                    </div>
                    <div class="stress-labels">
                        <span>Relaxed</span>
                        <span>Normal</span>
                        <span>Stressed</span>
                        <span>High Stress</span>
                    </div>
                    
                    <div class="chart-container">
                        <canvas id="gsrChart"></canvas>
                    </div>

                    <h3><i class="fas fa-clock"></i> Today's Forecast</h3>
                    <div class="hourly-forecast" id="hourly-forecast">
                        <!-- Will be populated by JavaScript -->
                    </div>
                </div>

                <div class="card recommendations-card">
                    <h3><i class="fas fa-lightbulb"></i> Recommendations</h3>
                    <div class="recommendations" id="recommendations">
                        <!-- Will be populated by JavaScript -->
                    </div>
                </div>
            </div>

            <div class="side-column">
                <div class="card metrics-card">
                    <h3><i class="fas fa-chart-line"></i> Key Metrics</h3>
                    <div class="metric-grid">
                        <div class="metric-item">
                            <label>Avg. Stress (24h)</label>
                            <div class="value" id="avg-stress">0%</div>
                            <div class="trend" id="avg-trend">
                                <i class="fas fa-minus"></i> Stable
                            </div>
                        </div>
                        <div class="metric-item">
                            <label>Peak Today</label>
                            <div class="value" id="peak-stress">0μS</div>
                            <div class="trend" id="peak-trend">
                                <i class="fas fa-minus"></i> Stable
                            </div>
                        </div>
                        <div class="metric-item">
                            <label>Stress Duration</label>
                            <div class="value" id="stress-duration">0 min</div>
                            <div class="trend" id="duration-trend">
                                <i class="fas fa-minus"></i> Stable
                            </div>
                        </div>
                        <div class="metric-item">
                            <label>Recovery Rate</label>
                            <div class="value" id="recovery-rate">0%</div>
                            <div class="trend" id="recovery-trend">
                                <i class="fas fa-minus"></i> Stable
                            </div>
                        </div>
                    </div>
                    <button class="btn-action" id="detail-btn">View Full Analysis</button>
                </div>

                <div class="card weekly-card">
                    <h3><i class="fas fa-calendar-week"></i> Weekly Overview</h3>
                    <div class="weekly-grid" id="weekly-grid">
                        <!-- Will be populated by JavaScript -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Trends Tab (new content) -->
    <div class="tab-content" id="trends">
        <div class="dashboard-grid">
            <div class="main-column">
                <div class="card">
                    <h3><i class="fas fa-chart-line"></i> Long-term Stress Trends</h3>
                    <div class="chart-container">
                        <canvas id="trendChart"></canvas>
                    </div>
                </div>
                
                <div class="card">
                    <h3><i class="fas fa-calendar-alt"></i> Monthly Stress Patterns</h3>
                    <div class="chart-container">
                        <canvas id="monthlyChart"></canvas>
                    </div>
                </div>
            </div>
            
            <div class="side-column">
                <div class="card">
                    <h3><i class="fas fa-clock"></i> Time-of-Day Analysis</h3>
                    <div class="chart-container">
                        <canvas id="timeOfDayChart"></canvas>
                    </div>
                    <div class="time-of-day-insights" id="time-of-day-insights">
                        <!-- Will be populated by JavaScript -->
                    </div>
                </div>
                
                <div class="card">
                    <h3><i class="fas fa-chart-bar"></i> Stress Triggers</h3>
                    <div class="stress-triggers" id="stress-triggers">
                        <!-- Will be populated by JavaScript -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Insights Tab (new content) -->
    <div class="tab-content" id="insights">
        <div class="dashboard-grid">
            <div class="main-column">
                <div class="card">
                    <h3><i class="fas fa-lightbulb"></i> Key Insights</h3>
                    <div class="insights-container" id="key-insights">
                        <!-- Will be populated by JavaScript -->
                    </div>
                </div>
                
                <div class="card">
                    <h3><i class="fas fa-project-diagram"></i> Stress Correlations</h3>
                    <div class="chart-container">
                        <canvas id="correlationChart"></canvas>
                    </div>
                </div>
            </div>
            
            <div class="side-column">
                <div class="card">
                    <h3><i class="fas fa-trophy"></i> Progress & Achievements</h3>
                    <div class="achievements-container" id="achievements">
                        <!-- Will be populated by JavaScript -->
                    </div>
                </div>
                
                <div class="card">
                    <h3><i class="fas fa-bell"></i> Personalized Alerts</h3>
                    <div class="alerts-container" id="personalized-alerts">
                        <!-- Will be populated by JavaScript -->
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Modal -->
<div class="modal-overlay" id="modal-overlay"></div>
<div class="modal" id="detail-modal">
    <div class="modal-content">
        <div class="modal-header">
            <h3><i class="fas fa-chart-bar"></i> Mental Health Analysis</h3>
            <button class="close-modal" id="close-modal">&times;</button>
        </div>
        <div class="analysis-grid" id="analysis-grid">
            <!-- Will be populated by JavaScript -->
        </div>
    </div>
</div>

<script>
// Add these variables at the top with other chart variables
let trendChart;
let monthlyChart;
let timeOfDayChart;
let correlationChart;

// Add these functions to your existing JavaScript

// Initialize trend charts
function initTrendCharts() {
    // Long-term trend chart
    const trendCtx = document.getElementById('trendChart').getContext('2d');
    trendChart = new Chart(trendCtx, {
        type: 'line',
        data: {
            labels: generateDateLabels(30), // Last 30 days
            datasets: [{
                label: 'Daily Stress Level',
                data: generateRandomData(30, 30, 70),
                borderColor: '#4A90E2',
                borderWidth: 2,
                fill: false,
                tension: 0.3
            }]
        },
        options: getTrendChartOptions('Daily Stress Levels Over Time')
    });
    
    // Monthly pattern chart
    const monthlyCtx = document.getElementById('monthlyChart').getContext('2d');
    monthlyChart = new Chart(monthlyCtx, {
        type: 'bar',
        data: {
            labels: ['Week 1', 'Week 2', 'Week 3', 'Week 4'],
            datasets: [{
                label: 'Average Stress',
                data: generateRandomData(4, 40, 60),
                backgroundColor: '#4A90E2',
                borderColor: '#4A90E2',
                borderWidth: 1
            }]
        },
        options: getTrendChartOptions('Monthly Stress Patterns by Week')
    });
    
    // Time of day chart
    const timeCtx = document.getElementById('timeOfDayChart').getContext('2d');
    timeOfDayChart = new Chart(timeCtx, {
        type: 'line',
        data: {
            labels: ['12AM', '3AM', '6AM', '9AM', '12PM', '3PM', '6PM', '9PM'],
            datasets: [{
                label: 'Average Stress',
                data: generateRandomData(8, 20, 80),
                borderColor: '#4A90E2',
                borderWidth: 2,
                fill: true,
                backgroundColor: 'rgba(74, 144, 226, 0.1)',
                tension: 0.3
            }]
        },
        options: getTrendChartOptions('Average Stress by Time of Day')
    });
    
    // Correlation chart
    const corrCtx = document.getElementById('correlationChart').getContext('2d');
    correlationChart = new Chart(corrCtx, {
        type: 'radar',
        data: {
            labels: ['Work Hours', 'Screen Time', 'Social', 'Exercise', 'Sleep', 'Nutrition'],
            datasets: [{
                label: 'Stress Correlation',
                data: [65, 59, 90, 81, 56, 55],
                backgroundColor: 'rgba(74, 144, 226, 0.2)',
                borderColor: '#4A90E2',
                pointBackgroundColor: '#4A90E2',
                pointBorderColor: '#fff',
                pointHoverBackgroundColor: '#fff',
                pointHoverBorderColor: '#4A90E2'
            }]
        },
        options: {
            responsive: true,
            plugins: {
                title: {
                    display: true,
                    text: 'Factors Correlated with Stress',
                    font: {
                        size: 14
                    }
                },
                legend: {
                    display: false
                }
            },
            scales: {
                r: {
                    angleLines: {
                        display: true
                    },
                    suggestedMin: 0,
                    suggestedMax: 100
                }
            }
        }
    });
}

// Common options for trend charts
function getTrendChartOptions(title) {
    return {
        responsive: true,
        plugins: {
            title: {
                display: true,
                text: title,
                font: {
                    size: 14
                }
            },
            legend: {
                display: false
            },
            tooltip: {
                mode: 'index',
                intersect: false
            }
        },
        scales: {
            y: {
                beginAtZero: false,
                min: 0,
                max: 100,
                ticks: {
                    callback: function(value) {
                        return value + '%';
                    }
                }
            }
        }
    };
}

// Generate insights content
function generateInsightsContent() {
    // Time of day insights
    document.getElementById('time-of-day-insights').innerHTML = `
        <div class="insight-item">
            <div class="insight-icon" style="background: var(--high-stress)">
                <i class="fas fa-exclamation"></i>
            </div>
            <div class="insight-content">
                <h4>High Stress Period</h4>
                <p>Your stress peaks between 2PM-4PM, likely due to work meetings.</p>
            </div>
        </div>
        <div class="insight-item">
            <div class="insight-icon" style="background: var(--relaxed)">
                <i class="fas fa-smile"></i>
            </div>
            <div class="insight-content">
                <h4>Low Stress Period</h4>
                <p>You're most relaxed in the evenings after 7PM.</p>
            </div>
        </div>
    `;
    
    // Stress triggers
    document.getElementById('stress-triggers').innerHTML = `
        <div class="trigger-item">
            <div class="trigger-category">Work</div>
            <div class="trigger-bar">
                <div class="trigger-fill" style="width: 75%; background: var(--stressed)"></div>
            </div>
            <div class="trigger-value">75% correlation</div>
        </div>
        <div class="trigger-item">
            <div class="trigger-category">Social</div>
            <div class="trigger-bar">
                <div class="trigger-fill" style="width: 60%; background: var(--normal)"></div>
            </div>
            <div class="trigger-value">60% correlation</div>
        </div>
        <div class="trigger-item">
            <div class="trigger-category">Sleep</div>
            <div class="trigger-bar">
                <div class="trigger-fill" style="width: 45%; background: var(--normal)"></div>
            </div>
            <div class="trigger-value">45% correlation</div>
        </div>
    `;
    
    // Key insights
    document.getElementById('key-insights').innerHTML = `
        <div class="key-insight positive">
            <i class="fas fa-check-circle"></i>
            <div>
                <h4>Improving Recovery</h4>
                <p>Your stress recovery rate has improved by 15% this month.</p>
            </div>
        </div>
        <div class="key-insight negative">
            <i class="fas fa-exclamation-triangle"></i>
            <div>
                <h4>Midweek Stress</h4>
                <p>Wednesdays are consistently your most stressful day.</p>
            </div>
        </div>
        <div class="key-insight positive">
            <i class="fas fa-check-circle"></i>
            <div>
                <h4>Morning Routine</h4>
                <p>Your new morning routine has reduced AM stress by 20%.</p>
            </div>
        </div>
    `;
    
    // Achievements
    document.getElementById('achievements').innerHTML = `
        <div class="achievement">
            <div class="achievement-badge" style="background: var(--relaxed)">
                <i class="fas fa-medal"></i>
            </div>
            <div class="achievement-content">
                <h4>5-Day Relaxation Streak</h4>
                <p>You've maintained low stress for 5 consecutive days!</p>
            </div>
        </div>
        <div class="achievement">
            <div class="achievement-badge" style="background: var(--primary)">
                <i class="fas fa-fire"></i>
            </div>
            <div class="achievement-content">
                <h4>Consistency Champion</h4>
                <p>Logged data for 30 days straight.</p>
            </div>
        </div>
    `;
    
    // Personalized alerts
    document.getElementById('personalized-alerts').innerHTML = `
        <div class="alert-item warning">
            <i class="fas fa-exclamation-triangle"></i>
            <div>
                <h4>Upcoming Stressful Period</h4>
                <p>Tomorrow 10AM-12PM is typically stressful for you.</p>
            </div>
        </div>
        <div class="alert-item info">
            <i class="fas fa-info-circle"></i>
            <div>
                <h4>Optimal Break Time</h4>
                <p>Your data suggests taking a break around 3:30PM.</p>
            </div>
        </div>
    `;
}

// Helper function to generate date labels
function generateDateLabels(count) {
    const labels = [];
    for (let i = count - 1; i >= 0; i--) {
        const date = new Date();
        date.setDate(date.getDate() - i);
        labels.push(date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' }));
    }
    return labels;
}

// Helper function to generate random data
function generateRandomData(count, min, max) {
    const data = [];
    for (let i = 0; i < count; i++) {
        data.push(Math.floor(Math.random() * (max - min + 1)) + min);
    }
    return data;
}

// Update the setupEventListeners function to handle tab switching
function setupEventListeners() {
    // Modal controls
    detailBtn.addEventListener('click', showDetailModal);
    closeModalBtn.addEventListener('click', hideDetailModal);
    modalOverlay.addEventListener('click', hideDetailModal);
    
    // Nav tabs
    document.querySelectorAll('.nav-tab').forEach(tab => {
        tab.addEventListener('click', () => {
            const tabId = tab.getAttribute('data-tab');
            
            // Update active tab
            document.querySelectorAll('.nav-tab').forEach(t => t.classList.remove('active'));
            tab.classList.add('active');
            
            // Show corresponding content
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            document.getElementById(tabId).classList.add('active');
            
            // Initialize charts if we're on the trends tab and charts aren't initialized
            if (tabId === 'trends' && !trendChart) {
                initTrendCharts();
                generateInsightsContent();
            }
        });
    });
    
    // Keyboard accessibility
    document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && modal.style.display === 'block') {
            hideDetailModal();
        }
    });
}

// Update the init function to include trend charts when needed
document.addEventListener('DOMContentLoaded', async () => {
    initChart();
    setupEventListeners();
    await loadInitialData();
    generateWeeklyData();
    generateHourlyForecast();
    generateRecommendations();
    startDataRefresh();
    
    // Initialize trend charts if we're already on the trends tab
    if (document.querySelector('.nav-tab.active').getAttribute('data-tab') === 'trends') {
        initTrendCharts();
        generateInsightsContent();
    }
});
</script>
    <script>
        // Register Service Worker
if ('serviceWorker' in navigator) {
  window.addEventListener('load', () => {
    navigator.serviceWorker.register('https://4211421036.github.io/pulsemind/sw.js')
      .then(registration => {
        console.log('SW registered: ', registration.scope);
      }).catch(err => {
        console.log('SW registration failed: ', err);
      });
  });
}
    </script>
</body>
</html>
